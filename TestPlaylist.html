<!DOCTYPE html>
<html>
	<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>curiousMidi</title>
		<style type="text/css">
      label.filebutton{width:120px;height:5px;position:relative;background-color:#eee;color:black}label span input{z-index:999;line-height:0;font-size:10px;position:absolute;top:-2px;left:-700px;opacity:0;filter:alpha(opacity=0);-ms-filter:"alpha(opacity=0)";cursor:pointer;_cursor:hand;margin:0;padding:0}
		</style>
    <style>
      .svg-icon{width:1em;height:1em}.svg-icon path,.svg-icon polygon,.svg-icon rect{fill:#4691f6}.svg-icon circle{stroke:#4691f6;stroke-width:1}#search{display:none;position:relative;top:0;z-index:9}#search input{height:100%;width:380px;outline:;background:gold;color:#131313;font-size:1em}::-webkit-input-placeholder{color:rgba(0,0,0,.4)}:-moz-placeholder{color:rgba(0,0,0,.4)}::-moz-placeholder{color:rgba(0,0,0,.4)}:-ms-input-placeholder{color:rgba(0,0,0,.4)}#togglesongholder{position:Absolute;top:0%;text-align:center}#songs{position:Absolute;background:rgba(117,91,48,1);height:80%;top:20%;overflow:scroll;padding-left:5px}@-webkit-keyframes pulse{0%{background-color:rgba(248,117,117,1)}25%{background-color:rgba(217,171,255,1)}50%{background-color:rgba(243,248,117,1)}75%{background-color:rgba(165,248,117,1)}100%{background-color:rgba(117,191,248,1)}}#songs table{width:100%;text-align:left}table tr:hover{background:rgba(255,255,255,.4);border-radius:5px;color:#131313;padding:20px 0}table tr{padding:10px 0;-webkit-user-select:none;user-select:none;cursor:default}table td{padding-top:3px;padding-bottom:3px;padding-right:5px}#playlist table tr.playing{font-style:italic}#songs table tr.playing{background:#76AD8B;font-style:italic}#playlist table tr.playing td{padding-left:50px}tr.hidden{display:none}::-webkit-scrollbar{width:5px;height:0}::-webkit-scrollbar-thumb{background-color:rgba(100,170,200,1);border-radius:0 1px 1px 0}::-webkit-scrollbar-track{background:rgba(117,191,248,.5)}#mydiv{position:absolute;z-index:9;width:400px;height:80%;left:350px;border:none}#mydivheader{padding:10px;cursor:move;z-index:10;color:#fff;height:50px;background:rgba(117,91,48,1)}
    </style>
    <script>
      function loadScript(e){var n=new XMLHttpRequest;n.overrideMimeType("text/plain; charset=utf-8"),n.open("GET",e,!0),n.onload=function(){var e=n.responseText;eval.apply(window,[e])},n.send(null)}loadScript("js/dirkncl.js");
    </script>
    <script>
      Mobile=/Android|webOS|iPhone|iPad|iPod/i.test(navigator.userAgent);var search='<svg class="svg-icon" viewBox="0 0 20 20"><path d="M18.125,15.804l-4.038-4.037c0.675-1.079,1.012-2.308,1.01-3.534C15.089,4.62,12.199,1.75,8.584,1.75C4.815,1.75,1.982,4.726,2,8.286c0.021,3.577,2.908,6.549,6.578,6.549c1.241,0,2.417-0.347,3.44-0.985l4.032,4.026c0.167,0.166,0.43,0.166,0.596,0l1.479-1.478C18.292,16.234,18.292,15.968,18.125,15.804 M8.578,13.99c-3.198,0-5.716-2.593-5.733-5.71c-0.017-3.084,2.438-5.686,5.74-5.686c3.197,0,5.625,2.493,5.64,5.624C14.242,11.548,11.621,13.99,8.578,13.99 M16.349,16.981l-3.637-3.635c0.131-0.11,0.721-0.695,0.876-0.884l3.642,3.639L16.349,16.981z"></path></svg>';window.M3U={};var playlist,fileName="midiCollection.m3u";function m3uLoad(e){var t=new XMLHttpRequest;t.overrideMimeType("text/xml; charset=iso-8859-1"),t.open("GET",e),t.onload=parse,t.send()}function parse(){getSongs(playlist=M3U.parse(this.response)),onload()}function getSongs(e){for(var t=[],n={},o=0;o<e.length;o++)(n=e[o]).count=o,t.push(n);TotalFile=n.count;var i=document.createElement("span");i.innerText="url files = "+TotalFile+" files",i.style="color:gold",document.getElementById("totalList").appendChild(i);var l=function(){if(t.length){var e=t.shift(),n=document.createElement("td"),o=document.createElement("tr");n.innerHTML=e.artist+"- "+e.title,o.appendChild(n),o.onclick=function(t){if(t&&1==t.button)o.parentNode.removeChild(o);else{midiPlay(e.file);for(var n=document.querySelectorAll(".playing"),i=n.length;i--;)n[i].className="";o.className+=" playing",currentSong=o,console,document.title="",documentTitle(e.title,300,15)}o.scrollIntoView({behavior:"instant",block:"nearest",inline:"nearest"})},0==document.getElementById("songtable").childNodes.length&&o.onclick(),document.getElementById("songtable").appendChild(o),l();var i=t.length;setTimeout(function(){t.length==i&&l()},300)}};l()}parser=function(e){return Data=e.replace(/\r/g,""),"#EXTM3U"===Data.substr(0,Data.search("\n"))?Data.substr(Data.search("\n")).split("\n#").filter(function(e){return!!e.trim().length}).map(function(e){var t;return(t=e.match(/:(?:(-?\d+),(.+)\s*-\s*(.+)|(.+))\n(.+)/))&&6===t.length?{length:t[1]||0,artist:t[2]||"",title:t[4]||t[3],file:t[5].trim()}:void 0}):Data.split("\n").filter(function(e){return!!e.trim().length}).filter(function(e){return"#"!==e[0]}).map(function(e){return{file:e.trim()}})},window.M3U={name:"m3u",parse:parser},m3uLoad(fileName);var titleDoc,currentSong=0;function nextSong(){try{currentSong.nextSibling.onclick(),currentSong.scrollIntoView({behavior:"instant",block:"center",inline:"nearest"})}catch(e){(currentSong=document.document.getElementsByTagNamer("tr")).onclick()}}function prevSong(){try{currentSong.previousSibling.onclick(),currentSong.scrollIntoView({behavior:"instant",block:"center",inline:"nearest"})}catch(e){(currentSong=document.getElementsByTagName("tr")).onclick()}}function shuffle(){for(var e=document.getElementById("songtable"),t=document.getElementsByTagName("tr"),n=t.length;n--;){var o=t[Math.floor(Math.random()*n)],i=t[n],l=o.nextSibling,r=i.nextSibling;e.insertBefore(o,r),e.insertBefore(i,l)}currentSong.scrollIntoView({behavior:"instant",block:"center",inline:"nearest"})}function runSearch(e){console.log(e);for(var t=new RegExp(e.trim().replace(/\s+/g,".*"),"ig"),n=document.getElementById("songtable").getElementsByTagName("tr"),o=n.length;o--;)t.test(n[o].innerHTML)?n[o].className="visible":n[o].className="hidden"}function docTitle(){titleDoc=titleDoc.substring(1,titleDoc.length)+titleDoc.substring(0,1),document.title=titleDoc,setTimeout("docTitle()",400)}function documentTitle(e){titleDoc=e+"--***--",docTitle()}function toggle_search(e){var t=document.getElementById("togglesearch"),n=document.getElementById(e).style,o=document.getElementById("searchIn");"block"==n.display?(n.display="none",t.innerHTML=search):(n.display="block",o.focus(),t.innerHTML=search)}function toggle_showSong(e){var t=document.getElementById("togglesong"),n=document.getElementById(e).style;"80%"==n.height?(n.height="0%",t.innerHTML="&blacktriangle;",t.title="Show List"):(n.height="80%",t.innerHTML="&blacktriangledown;",t.title="Hide List")}onload=function(){document.querySelector("input").onkeydown=function(e){if(13==e.keyCode)for(var t=document.querySelectorAll("tr.visible"),n=t.length;n--;)t[n].onclick()}};
    </script>
    <script type='text/javascript'>
      function fileExtension(e){var i=e.split(".");return i[i.length-1].toLowerCase()}var midiNameIndex,ext,titleDoc,midiName=[],GetFiles=function(){for(var e=document.querySelector("#myfiles").files,i=midiNameIndex=e.length,t=0;t<i;)fileExtension("mid"==e[t].name||"kar")&&(midiName[t]=e[t]),t++;var n="<form name='MidiForm' method='POST'><span style='font-size: 9pt'><font size='1'><select size='1' name='Pilihan'  multiple='true' style='height:150px' onchange='runMidiPlay(this.selectedIndex)' style='font-size: 9pt'>";for(t=0;t<midiName.length;t++)n=n+"<option>"+midiName[t].name+"</option>";n+="</select></font></span></form>",document.getElementById("selectfile").innerHTML=n,document.MidiForm.Pilihan.selectedIndex=Math.floor(Math.random()*midiName.length),runMidiPlay(document.MidiForm.Pilihan.selectedIndex)},GetDir=function(){for(var e=document.querySelector("#myDir").files,i=midiNameIndex=e.length,t=0;t<i;)midiName[t]=e[t],t++;var n="<form name='MidiForm' method='POST'><span style='font-size: 9pt'><font size='1'><select size='1' name='Pilihan'  multiple='true' style='height:150px' onchange='runMidiPlay(this.selectedIndex)' style='font-size: 9pt'>";for(t=0;t<midiName.length;t++)n=n+"<option>"+midiName[t].name+"</option>";n+="</select></font></span></form>",document.getElementById("selectfile").innerHTML=n,document.MidiForm.Pilihan.selectedIndex,Math.floor(Math.random()*midiName.length),runMidiPlay(document.MidiForm.Pilihan.selectedIndex)},selectedFile=0,current=0;function runMidiPlay(e){ext=fileExtension(midiName[e].name),document.title="",selectedFile=e,"mid"==ext||"kar"==ext||"midi"==ext||"rmi"==ext?(midiPlay(URL.createObjectURL(midiName[e])),document.MidiForm.Pilihan.selectedIndex=e,documentTitle(midiName[e].name)):PlayNext()}function PlayRandom(){var e;document.title="",e=Math.floor(Math.random()*midiName.length),runMidiPlay(current=selectedFile=e)}function PlayNext(){current===midiName.length-1?current=0:current++,runMidiPlay(current)}function PlayPrev(){0===current?current=midiName.length-1:current--,runMidiPlay(current)}function docTitle(){titleDoc=titleDoc.substring(1,titleDoc.length)+titleDoc.substring(0,1),document.title=titleDoc,setTimeout("docTitle()",400)}function documentTitle(e){titleDoc=e+"--***--",docTitle()} 

    </script>	
    <script type='text/javascript'>
      window.onload=function(){Mobile?document.getElementById("mydiv").style.left="0px":document.getElementById("mydiv").style.left="350px";var e=document.getElementById("time_button");midiPlayTime=function(t){var n=parseInt(t.time/60)%60;n<10&&(n="0"+n);var c=parseInt(t.time%60);c<10&&(c="0"+c);e.value=n+":"+c}},document.addEventListener("keydown",function(e){if(27==e.keyCode||!KeyState&&!e.metaKey)switch(e.ctrlKey){case!1:switch(e.keyCode){case 9:e.preventDefault(),midiStop(),shuffle();break;case 37:e.preventDefault(),midiStop(),prevSong();break;case 39:e.preventDefault(),midiStop(),nextSong()}break;case!0:switch(e.keyCode){case 83:e.preventDefault(),document.getElementById("togglesearch").click();break;case 76:e.preventDefault(),document.getElementById("togglesong").click();break;case 70:e.preventDefault(),document.querySelector("#myfiles").click();break;case 68:e.preventDefault(),document.querySelector("#myDir").click()}}});
    </script>		

  </head>
	<body style="background-color:black">
  <div id="totalList"></div>  
  <pre style="position:absolute;color:gold">
  shortcut:
  [tab]       : shuffle url list
  [space]     : stop playing
  left arrow  : prev. song in url list
  right arrow : next song in url list
  up arrow    : increase volume
  down arrow  : decrease volume  
  [ctrl] + c  : toggle sound compressor
  [ctrl] + s  : search in url list
  [ctrl] + f  : open files in local list
  [ctrl] + d  : open folder in local list
  [ctrl] + l  : toggle show/hide url list 
  {l = lower case from L}
  </pre>		
		
    <!------------------------------------------------------------>
		<div style="position:absolute; bottom:2px;right:2px; z-index:1000" class="pick">
      <div>
        <label class="filebutton">Choose Dir!
          <span>
            <!--accept=".mid,.kar,.midi,.rmi"-->
            <input style="display:block" id="myDir" type="file" name="myDir"  accept=".mid,.kar,.midi,.rmi" multiple webkitdirectory onchange="GetDir()">
          </span>
        </label> or 
        
        <label class="filebutton">Choose Files!
          <span>
            <!--accept=".mid,.kar,.midi,.rmi"-->
            <input style="display:block" id="myfiles" type="file" name="myFiles" accept=".mid,.kar,.midi,.rmi" multiple onchange="GetFiles()">
          </span>
        </label>
      </div>
      <div id="selectfile" style="width:30px"></div>
      <button id='random' onclick='midiStop();'>Stop</button>
      <button id='random' onclick='PlayRandom()'>Random</button>
      <button id='prev' onclick='PlayPrev()'><<</button>
      <button id='next' onclick='PlayNext()'>>></button>
      <input id="time_button" type="button"></input>
    </div>
    
    <div id="mydiv">
      <div id="mydivheader">
      
        <div id='togglesongholder'>
          
          <div id="search">
            <input id='searchIn' type="text" placeholder="Search: song" spellcheck=off autocomplete=on oninput="runSearch(this.value)">
          </div>
          
          <a id='togglesearch' style='text-decoration:none;font-color:blue;font-size:34px' href="javascript:toggle_search('search')"><svg width='12px' class="svg-icon" viewBox="0 0 20 20"><path d="M18.125,15.804l-4.038-4.037c0.675-1.079,1.012-2.308,1.01-3.534C15.089,4.62,12.199,1.75,8.584,1.75C4.815,1.75,1.982,4.726,2,8.286c0.021,3.577,2.908,6.549,6.578,6.549c1.241,0,2.417-0.347,3.44-0.985l4.032,4.026c0.167,0.166,0.43,0.166,0.596,0l1.479-1.478C18.292,16.234,18.292,15.968,18.125,15.804 M8.578,13.99c-3.198,0-5.716-2.593-5.733-5.71c-0.017-3.084,2.438-5.686,5.74-5.686c3.197,0,5.625,2.493,5.64,5.624C14.242,11.548,11.621,13.99,8.578,13.99 M16.349,16.981l-3.637-3.635c0.131-0.11,0.721-0.695,0.876-0.884l3.642,3.639L16.349,16.981z"></path></svg></a>   
          <a id='togglesong' style='text-decoration:none;font-color:blue;font-size:34px' href="javascript:toggle_showSong('songs')">&blacktriangledown;</a>
          <a style='text-decoration:none;font-color:blue;font-size:34px' href="javascript:"> | </a>
          <a style='text-decoration:none;font-color:blue;font-size:34px' href="javascript:shuffle()"><svg class="svg-icon" viewBox="0 0 20 20"><path d="M12.319,5.792L8.836,2.328C8.589,2.08,8.269,2.295,8.269,2.573v1.534C8.115,4.091,7.937,4.084,7.783,4.084c-2.592,0-4.7,2.097-4.7,4.676c0,1.749,0.968,3.337,2.528,4.146c0.352,0.194,0.651-0.257,0.424-0.529c-0.415-0.492-0.643-1.118-0.643-1.762c0-1.514,1.261-2.747,2.787-2.747c0.029,0,0.06,0,0.09,0.002v1.632c0,0.335,0.378,0.435,0.568,0.245l3.483-3.464C12.455,6.147,12.455,5.928,12.319,5.792 M8.938,8.67V7.554c0-0.411-0.528-0.377-0.781-0.377c-1.906,0-3.457,1.542-3.457,3.438c0,0.271,0.033,0.542,0.097,0.805C4.149,10.7,3.775,9.762,3.775,8.76c0-2.197,1.798-3.985,4.008-3.985c0.251,0,0.501,0.023,0.744,0.069c0.212,0.039,0.412-0.124,0.412-0.34v-1.1l2.646,2.633L8.938,8.67z M14.389,7.107c-0.34-0.18-0.662,0.244-0.424,0.529c0.416,0.493,0.644,1.118,0.644,1.762c0,1.515-1.272,2.747-2.798,2.747c-0.029,0-0.061,0-0.089-0.002v-1.631c0-0.354-0.382-0.419-0.558-0.246l-3.482,3.465c-0.136,0.136-0.136,0.355,0,0.49l3.482,3.465c0.189,0.186,0.568,0.096,0.568-0.245v-1.533c0.153,0.016,0.331,0.022,0.484,0.022c2.592,0,4.7-2.098,4.7-4.677C16.917,9.506,15.948,7.917,14.389,7.107 M12.217,15.238c-0.251,0-0.501-0.022-0.743-0.069c-0.212-0.039-0.411,0.125-0.411,0.341v1.101l-2.646-2.634l2.646-2.633v1.116c0,0.174,0.126,0.318,0.295,0.343c0.158,0.024,0.318,0.034,0.486,0.034c1.905,0,3.456-1.542,3.456-3.438c0-0.271-0.032-0.541-0.097-0.804c0.648,0.719,1.022,1.659,1.022,2.66C16.226,13.451,14.428,15.238,12.217,15.238"></path></svg></a>
          <a style='text-decoration:none;font-color:blue;font-size:34px' href="javascript:prevSong()"> &blacktriangleleft; </a>
          <a style='text-decoration:none;font-color:blue;font-size:34px' href="javascript:nextSong()"> &blacktriangleright; </a>
          
        </div>  
        <div id="songs">
          <table id="songtable" cellspacing=0 cellpadding=0></table>
        </div>
        
      </div>
    </div>
    <script>
      function dragElement(e){var n=0,t=0,o=0,u=0;function d(e){(e=e||window.event).preventDefault(),o=e.clientX,u=e.clientY,document.onmouseup=l,document.onmousemove=m}function m(d){(d=d||window.event).preventDefault(),n=o-d.clientX,t=u-d.clientY,o=d.clientX,u=d.clientY,e.style.top=e.offsetTop-t+"px",e.style.left=e.offsetLeft-n+"px"}function l(){document.onmouseup=null,document.onmousemove=null}document.getElementById(e.id+"header")?document.getElementById(e.id+"header").onmousedown=d:e.onmousedown=d}dragElement(document.getElementById("mydiv"));
    </script>
  </body>
</html>
